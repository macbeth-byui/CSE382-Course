<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>lesson08.md</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__left">
    <div class="stackedit__toc">
      
<ul>
<li><a href="#cse-382-lesson-8---tree-data-structure">CSE 382 Lesson 8 - Tree Data Structure</a>
<ul>
<li><a href="#part-1---binary-search-tree">Part 1 - Binary Search Tree</a></li>
<li><a href="#problem-set-1">Problem Set 1</a></li>
<li><a href="#part-2---balanced-red-black-tree">Part 2 - Balanced Red-Black Tree</a></li>
<li><a href="#problem-set-2">Problem Set 2</a></li>
<li><a href="#part-3---performance">Part 3 - Performance</a></li>
<li><a href="#problem-set-3">Problem Set 3</a></li>
</ul>
</li>
</ul>

    </div>
  </div>
  <div class="stackedit__right">
    <div class="stackedit__html">
      <h1 id="cse-382-lesson-8---tree-data-structure">CSE 382 Lesson 8 - Tree Data Structure</h1>
<p>In this lesson we will learn about our second data structure called the Binary Search Tree.  When we learned about persistence we learned about the list as it is implemented in Erlang.  When we learned about monads, we introduced a new version of the list which was created using our own custom tuples.  The Binary Search Tree will use this same custom approach.</p>
<p>You can find the template for the problem sets in this lesson here: <a href="https://macbeth-byui.github.io/cse382-course/proves/prove08.erl">prove08.erl</a></p>
<h2 id="part-1---binary-search-tree">Part 1 - Binary Search Tree</h2>
<p>A binary search tree is a tree that stores smaller values to the left and larger values to the right.  Each node in the tree in defined by 3 fields: value, link to the left sub-tree, and link to the right sub-tree.</p>
<p>The tree is useful because we can quickly search for values by asking ourselves, “is the value we are looking for larger or smaller (or maybe we found it) than the one in the current node of the tree?”  This is like guessing a number between 1 and 100 and always guessing 50 first.  Searching in the tree will ideally exclude half of the values with each comparison.  We will explore this “ideal” performance in the next part of the lesson.</p>
<p>Persistence is a curious thing to consider visually with the tree.  In the diagram below, we show the creation of a tree with one node valued 10 called <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">T_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> .</p>
<p><img src="https://macbeth-byui.github.io/cse382-course/images/bst_1.drawio.png" alt="bst 1"></p>
<p>When we add a new node with value 7 (in this case something that will go left of the root node), we must persist <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">T_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>.  Since the left link in the root node must change, then we need a new node to create <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>.</p>
<p><img src="https://macbeth-byui.github.io/cse382-course/images/bst_2.drawio.png" alt="bst 2"></p>
<p>If we now add a node with value 15 to the right of the root node, we are only affecting the right link.  The new node we created in the previous step can be reused in creating <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">T_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>.</p>
<p><img src="https://macbeth-byui.github.io/cse382-course/images/bst_3.drawio.png" alt="bst 3"></p>
<p>In the next diagram we show the creation of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">T_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> by adding the new node with value 13.</p>
<p><img src="https://macbeth-byui.github.io/cse382-course/images/bst_4.drawio.png" alt="bst 4"></p>
<p>In the next diagram we show the creation of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>5</mn></msub></mrow><annotation encoding="application/x-tex">T_5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> by adding the new node with value 9.</p>
<p><img src="https://macbeth-byui.github.io/cse382-course/images/bst_5.drawio.png" alt="bst 5"></p>
<p>Finally, we show the creation of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>6</mn></msub></mrow><annotation encoding="application/x-tex">T_6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> by adding the new new node 5.</p>
<p><img src="https://macbeth-byui.github.io/cse382-course/images/bst_6.drawio.png" alt="bst 6"></p>
<p>The software will discard older versions of the Tree when they are not needed anymore.  However, the persistence we use in the data structure is important to satisfy the immutability rules.</p>
<p>Notice that the there is always a path through the tree that we have to re-create from the root node down to the node that we added.  When we reuse a node in the tree, we will reuse both the node and all the nodes it is connected too.  We will not have to have use recursion when we reuse a node.</p>
<p>Let’s begin with the structure of the node:</p>
<blockquote>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>t</mi><mi>r</mi><mi>u</mi><mi>c</mi><mi>t</mi><mtext>&nbsp;&nbsp;</mtext><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi><mtext>&nbsp;&nbsp;</mtext><mo stretchy="false">{</mo><mi>a</mi><mo>:</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo separator="true">,</mo><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi><mo>:</mo><mrow><mi>L</mi><mi>e</mi><mi>f</mi><mi>t</mi></mrow><mo separator="true">,</mo><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi><mo>:</mo><mi>R</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">}</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">struct ~ ~ node ~ ~ \lbrace a:Value, node:\mathit{Left}, node:Right \rbrace.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mord mathnormal">u</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mopen">{</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit">Left</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.00773em;">R</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span><span class="mclose">}</span><span class="mord">.</span></span></span></span></span></p>
</blockquote>
<p>We will implement two functions in our binary search tree.  The <code>add</code> function will add a value to the tree and the <code>contains</code> function will search the tree for a value and return a true or false.  When we add to a tree or we search in a tree, we will do so recursively through nodes beginning with the root node.  When we add to a tree, the result will be an updated root node (or an updated sub-tree root node as we recursively create our new tree).</p>
<blockquote>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>p</mi><mi>e</mi><mi>c</mi><mtext>&nbsp;&nbsp;</mtext><mi>a</mi><mi>d</mi><mi>d</mi><mo>:</mo><mo>:</mo><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi><mtext>&nbsp;&nbsp;</mtext><mi>a</mi><mo>→</mo><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">spec ~ ~ add :: node ~ ~ a \rightarrow node.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">ec</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">::</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord">.</span></span></span></span></span></p>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>p</mi><mi>e</mi><mi>c</mi><mtext>&nbsp;&nbsp;</mtext><mi>c</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>s</mi><mo>:</mo><mo>:</mo><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi><mtext>&nbsp;&nbsp;</mtext><mi>a</mi><mo>→</mo><mi>b</mi><mi>o</mi><mi>o</mi><mi>l</mi><mi>e</mi><mi>a</mi><mi>n</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">spec ~ ~ contains :: node ~ ~ a \rightarrow boolean.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">ec</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">co</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord mathnormal">ain</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">::</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">b</span><span class="mord mathnormal">oo</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">an</span><span class="mord">.</span></span></span></span></span></p>
</blockquote>
<p>In our specification, we are assuming that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">a</span></span></span></span></span> represents a type that can be compared with boolean operators.</p>
<p>There are 4 scenarios when adding a new item to a tree:</p>
<ul>
<li>Empty Tree - Create a new root <code>node</code>.  We will define an empty tree as <code>nil</code>.</li>
<li>Value to add is less than the current node value - Create a new <code>node</code> reusing the right link.  The left link is created by recursively calling <code>add</code> on the left sub-tree.</li>
<li>Value to add is greater than the current node value - Create a new <code>node</code> reusing the left link.  The right link is created by recursively calling <code>add</code> on the right sub-tree.</li>
<li>Value to add is equal to the current node value - In our tree, we will require all values to be unique.  In this case, we get to reuse the entire node including both left and right links.  The tree can be implemented differently by allowing duplicates perhaps stored to the right.</li>
</ul>
<p>The definition for <code>add</code> is given below.  The implementation for both <code>add</code> and <code>contains</code> will be left for an exercise.</p>
<blockquote>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>d</mi><mi>e</mi><mi>f</mi></mrow><mtext>&nbsp;&nbsp;</mtext><mi>a</mi><mi>d</mi><mi>d</mi><mo>:</mo><mo>:</mo><mi>n</mi><mi>i</mi><mi>l</mi><mtext>&nbsp;&nbsp;</mtext><mi>N</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo>→</mo><mo stretchy="false">{</mo><mi>N</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo separator="true">,</mo><mi>n</mi><mi>i</mi><mi>l</mi><mo separator="true">,</mo><mi>n</mi><mi>i</mi><mi>l</mi><mo stretchy="false">}</mo><mo separator="true">;</mo></mrow><annotation encoding="application/x-tex">\mathit{def} ~ ~ add :: nil ~ ~ New\_Value \rightarrow \lbrace New\_Value, nil, nil \rbrace;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit">def</span></span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">::</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.00444em; vertical-align: -0.31em;"></span><span class="mord mathnormal">ni</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">ni</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">ni</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mclose">}</span><span class="mpunct">;</span></span></span></span></span></p>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>d</mi><mi>e</mi><mi>f</mi></mrow><mtext>&nbsp;&nbsp;</mtext><mi>a</mi><mi>d</mi><mi>d</mi><mo>:</mo><mo>:</mo><mo stretchy="false">{</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo separator="true">,</mo><mi>L</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo separator="true">,</mo><mi>R</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">}</mo><mtext>&nbsp;&nbsp;</mtext><mi>N</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo>→</mo><mo stretchy="false">{</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo separator="true">,</mo><mo stretchy="false">(</mo><mi>a</mi><mi>d</mi><mi>d</mi><mtext>&nbsp;&nbsp;</mtext><mi>L</mi><mi>e</mi><mi>f</mi><mi>t</mi><mtext>&nbsp;&nbsp;</mtext><mi>N</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>R</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">}</mo><mtext>&nbsp;&nbsp;when&nbsp;&nbsp;</mtext><mi>N</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo>&lt;</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo separator="true">;</mo></mrow><annotation encoding="application/x-tex">\mathit{def} ~ ~ add :: \lbrace Value, Left, Right \rbrace ~ ~ New\_Value \rightarrow \lbrace Value, (add ~ ~ Left ~ ~ New\_Value), Right \rbrace ~ ~ \text{when} ~ ~ New\_Value \lt Value;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit">def</span></span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">::</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mopen">{</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.00773em;">R</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span><span class="mclose">}</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mopen">{</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">L</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.00773em;">R</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span><span class="mclose">}</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord text"><span class="mord">when</span></span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mpunct">;</span></span></span></span></span></p>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>d</mi><mi>e</mi><mi>f</mi></mrow><mtext>&nbsp;&nbsp;</mtext><mi>a</mi><mi>d</mi><mi>d</mi><mo>:</mo><mo>:</mo><mo stretchy="false">{</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo separator="true">,</mo><mi>L</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo separator="true">,</mo><mi>R</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">}</mo><mtext>&nbsp;&nbsp;</mtext><mi>N</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo>→</mo><mo stretchy="false">{</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo separator="true">,</mo><mi>L</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo separator="true">,</mo><mo stretchy="false">(</mo><mi>a</mi><mi>d</mi><mi>d</mi><mtext>&nbsp;&nbsp;</mtext><mi>R</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mtext>&nbsp;&nbsp;</mtext><mi>N</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo><mtext>&nbsp;&nbsp;when&nbsp;&nbsp;</mtext><mi>N</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo>&gt;</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo separator="true">;</mo></mrow><annotation encoding="application/x-tex">\mathit{def} ~ ~ add :: \lbrace Value, Left, Right \rbrace ~ ~ New\_Value \rightarrow \lbrace Value, Left, (add ~ ~ Right ~ ~ New\_Value) \rbrace ~ ~ \text{when} ~ ~ New\_Value \gt Value;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit">def</span></span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">::</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mopen">{</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.00773em;">R</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span><span class="mclose">}</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mopen">{</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.00773em;">R</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mclose">)}</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord text"><span class="mord">when</span></span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mpunct">;</span></span></span></span></span></p>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>d</mi><mi>e</mi><mi>f</mi></mrow><mtext>&nbsp;&nbsp;</mtext><mi>a</mi><mi>d</mi><mi>d</mi><mo>:</mo><mo>:</mo><mi>N</mi><mi>o</mi><mi>d</mi><mi>e</mi><mtext>&nbsp;&nbsp;</mtext><mi>N</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo>→</mo><mi>N</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\mathit{def} ~ ~ add :: Node ~ ~ New\_Value \rightarrow Node.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit">def</span></span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">::</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.00444em; vertical-align: -0.31em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord">.</span></span></span></span></span></p>
</blockquote>
<h2 id="problem-set-1">Problem Set 1</h2>
<ol>
<li>Implement the <code>add</code> function per the specification and definition above.  Use the test code provided.</li>
<li>Implement the <code>contains</code> function per the specification above.  Use the test code provided.</li>
</ol>
<h2 id="part-2---balanced-red-black-tree">Part 2 - Balanced Red-Black Tree</h2>
<p>Since a binary search tree orders left and right of node relative to the values, traversing the tree (either to insert or find) can provide an O(log n) performance.  However, this can only be achieved if the tree is balanced.  If we added the numbers 1, 2, 3, 4, 5, 6, 7 in order to a tree, they would also be add to the right.  Searching for a number in the tree would be the same as searching a list which is O(n)</p>
<p><img src="https://macbeth-byui.github.io/cse382-course/images/unbalanced_tree.drawio.png" alt="unbalanced_tree"></p>
<p>However, if the numbers were added 4, 2, 6, 1, 3, 5, 7 then we would get a tree that allows for the maximum exclusion of values every time we go left or right.</p>
<p><img src="https://macbeth-byui.github.io/cse382-course/images/balanced_tree.drawio.png" alt="balanced_tree"></p>
<p>Since we can’t rely on the order of the data, there are other  strategies and algorithms that can be used.  A common one is the Red Back Tree (RBT).  The RBT uses a set of rules to determine if part of a tree is unbalanced.  If something is unbalanced, a modification is made to balance the tree.  In other words, after the creation of any node in the <code>add</code> function, we will potentially perform a <code>balance</code> function.</p>
<p>The rules for an RBT are as follows:</p>
<ol>
<li>Every node is either red or black - In our algorithm we will choose to start all nodes out red.</li>
<li>The root is always black - In our algorithm we will choose to change the root node to black after the inserting and all balancing is completed.</li>
<li>No two adjacent nodes are red.</li>
<li>Every path from a node to a leaf has the same number of black nodes.</li>
</ol>
<p>In our algorithm we will enforce rules and 3 and 4 with our balancing function.</p>
<p>To support these rules, the structure of the node must change to include the color of the node:</p>
<blockquote>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>t</mi><mi>r</mi><mi>u</mi><mi>c</mi><mi>t</mi><mtext>&nbsp;&nbsp;</mtext><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">struct ~ ~ node</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mord mathnormal">u</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span></span></span></span></span><br>
<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mo stretchy="false">{</mo><mi>a</mi><mi>t</mi><mi>o</mi><mi>m</mi><mo stretchy="false">(</mo><mi>r</mi><mi>e</mi><mi>d</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>a</mi><mo>:</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo separator="true">,</mo><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi><mo>:</mo><mrow><mi>L</mi><mi>e</mi><mi>f</mi><mi>t</mi></mrow><mo separator="true">,</mo><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi><mo>:</mo><mi>R</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">}</mo><mtext>&nbsp;&nbsp;</mtext><mi>o</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">\kern{2em}\lbrace atom(red), a:Value, node:\mathit{Left}, node:Right \rbrace ~ ~ or</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mopen">{</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord mathnormal">re</span><span class="mord mathnormal">d</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit">Left</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.00773em;">R</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span><span class="mclose">}</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.02778em;">or</span></span></span></span></span><br>
<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mo stretchy="false">{</mo><mi>a</mi><mi>t</mi><mi>o</mi><mi>m</mi><mo stretchy="false">(</mo><mi>b</mi><mi>l</mi><mi>a</mi><mi>c</mi><mi>k</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>a</mi><mo>:</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo separator="true">,</mo><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi><mo>:</mo><mrow><mi>L</mi><mi>e</mi><mi>f</mi><mi>t</mi></mrow><mo separator="true">,</mo><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi><mo>:</mo><mi>R</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">}</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\kern{2em}\lbrace atom(black), a:Value, node:\mathit{Left}, node:Right \rbrace.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mopen">{</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit">Left</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.00773em;">R</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span><span class="mclose">}</span><span class="mord">.</span></span></span></span></span></p>
</blockquote>
<p>We will use the function names <code>add_rbt</code> and <code>contains_rbt</code> so they are unique from the traditional binary search tree.  These <code>contains_rbt</code> is the same as <code>contains</code> as the color is only important for adding and therefore is unused in the <code>contains_rbt</code>.</p>
<p>The <code>add_rbt</code> function is very similar to the <code>add</code> with the following distinctions:</p>
<ul>
<li>When we create a new node we color it red</li>
<li>When we create a new node that reuses one link and recursively adds the node on the other link, we need to call a <code>balance</code> function (discussed later) on the new node we created.</li>
<li>When we are done adding the node, we need to change the root node to be black.  This will necessitate a helper function so that we have <code>add_rbt</code> and <code>add_rbt_</code> both.</li>
</ul>
<p>The specification and definition for the <code>add_rbt</code> is shown below:</p>
<blockquote>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>p</mi><mi>e</mi><mi>c</mi><mtext>&nbsp;&nbsp;</mtext><mi>a</mi><mi>d</mi><mi>d</mi><mi mathvariant="normal">_</mi><mi>r</mi><mi>b</mi><mi>t</mi><mo>:</mo><mo>:</mo><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi><mtext>&nbsp;&nbsp;</mtext><mi>a</mi><mo>→</mo><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">spec ~ ~ add\_rbt :: node ~ ~ a \rightarrow node.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.00444em; vertical-align: -0.31em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">ec</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mord mathnormal">b</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">::</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord">.</span></span></span></span></span><br>
<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>p</mi><mi>e</mi><mi>c</mi><mtext>&nbsp;&nbsp;</mtext><mi>a</mi><mi>d</mi><mi>d</mi><mi mathvariant="normal">_</mi><mi>r</mi><mi>b</mi><mi>t</mi><mi mathvariant="normal">_</mi><mo>:</mo><mo>:</mo><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi><mtext>&nbsp;&nbsp;</mtext><mi>a</mi><mo>→</mo><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">spec ~ ~ add\_rbt\_ :: node ~ ~ a \rightarrow node.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.00444em; vertical-align: -0.31em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">ec</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mord mathnormal">b</span><span class="mord mathnormal">t</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">::</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord">.</span></span></span></span></span></p>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>d</mi><mi>e</mi><mi>f</mi></mrow><mtext>&nbsp;&nbsp;</mtext><mi>a</mi><mi>d</mi><mi>d</mi><mi mathvariant="normal">_</mi><mi>r</mi><mi>b</mi><mi>t</mi><mo>:</mo><mo>:</mo><mi>T</mi><mi>r</mi><mi>e</mi><mi>e</mi><mtext>&nbsp;&nbsp;</mtext><mi>N</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo>→</mo></mrow><annotation encoding="application/x-tex">\mathit{def} ~ ~ add\_rbt :: Tree ~ ~ New\_Value \rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.00444em; vertical-align: -0.31em;"></span><span class="mord"><span class="mord mathit">def</span></span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mord mathnormal">b</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">::</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.00444em; vertical-align: -0.31em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mord mathnormal">ree</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span></span></span></span></span><br>
<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mi>N</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>R</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo>=</mo><mo stretchy="false">(</mo><mi>a</mi><mi>d</mi><mi>d</mi><mi mathvariant="normal">_</mi><mi>r</mi><mi>b</mi><mi>t</mi><mi mathvariant="normal">_</mi><mtext>&nbsp;&nbsp;</mtext><mi>T</mi><mi>r</mi><mi>e</mi><mi>e</mi><mtext>&nbsp;&nbsp;</mtext><mi>N</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\kern{2em}New\_Root = (add\_rbt\_ ~ ~ Tree ~ ~ New\_Value),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.99333em; vertical-align: -0.31em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal" style="margin-right: 0.00773em;">R</span><span class="mord mathnormal">oo</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mord mathnormal">b</span><span class="mord mathnormal">t</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mord mathnormal">ree</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></span><br>
<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mo stretchy="false">{</mo><mi>b</mi><mi>l</mi><mi>a</mi><mi>c</mi><mi>k</mi><mo separator="true">,</mo><mi>N</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>R</mi><mi>o</mi><mi>o</mi><mi>t</mi><mi mathvariant="normal">.</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo separator="true">,</mo><mi>N</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>R</mi><mi>o</mi><mi>o</mi><mi>t</mi><mi mathvariant="normal">.</mi><mrow><mi>L</mi><mi>e</mi><mi>f</mi><mi>t</mi></mrow><mo separator="true">,</mo><mi>N</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>R</mi><mi>o</mi><mi>o</mi><mi>t</mi><mi mathvariant="normal">.</mi><mi>R</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">}</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\kern{2em}\lbrace black, New\_Root.Value, New\_Root.\mathit{Left}, New\_Root.Right \rbrace.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mopen">{</span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal" style="margin-right: 0.00773em;">R</span><span class="mord mathnormal">oo</span><span class="mord mathnormal">t</span><span class="mord">.</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal" style="margin-right: 0.00773em;">R</span><span class="mord mathnormal">oo</span><span class="mord mathnormal">t</span><span class="mord">.</span><span class="mord"><span class="mord mathit">Left</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal" style="margin-right: 0.00773em;">R</span><span class="mord mathnormal">oo</span><span class="mord mathnormal">t</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right: 0.00773em;">R</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span><span class="mclose">}</span><span class="mord">.</span></span></span></span></span></p>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>d</mi><mi>e</mi><mi>f</mi></mrow><mtext>&nbsp;&nbsp;</mtext><mi>a</mi><mi>d</mi><mi>d</mi><mi mathvariant="normal">_</mi><mi>r</mi><mi>b</mi><mi>t</mi><mi mathvariant="normal">_</mi><mo>:</mo><mo>:</mo><mi>n</mi><mi>i</mi><mi>l</mi><mtext>&nbsp;&nbsp;</mtext><mi>N</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo>→</mo><mo stretchy="false">{</mo><mi>r</mi><mi>e</mi><mi>d</mi><mo separator="true">,</mo><mi>N</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo separator="true">,</mo><mi>n</mi><mi>i</mi><mi>l</mi><mo separator="true">,</mo><mi>n</mi><mi>i</mi><mi>l</mi><mo stretchy="false">}</mo><mo separator="true">;</mo></mrow><annotation encoding="application/x-tex">\mathit{def} ~ ~ add\_rbt\_ :: nil ~ ~ New\_Value \rightarrow \lbrace red, New\_Value, nil, nil \rbrace;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.00444em; vertical-align: -0.31em;"></span><span class="mord"><span class="mord mathit">def</span></span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mord mathnormal">b</span><span class="mord mathnormal">t</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">::</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.00444em; vertical-align: -0.31em;"></span><span class="mord mathnormal">ni</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mopen">{</span><span class="mord mathnormal">re</span><span class="mord mathnormal">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">ni</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">ni</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mclose">}</span><span class="mpunct">;</span></span></span></span></span></p>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>d</mi><mi>e</mi><mi>f</mi></mrow><mtext>&nbsp;&nbsp;</mtext><mi>a</mi><mi>d</mi><mi>d</mi><mi mathvariant="normal">_</mi><mi>r</mi><mi>b</mi><mi>t</mi><mi mathvariant="normal">_</mi><mo>:</mo><mo>:</mo><mo stretchy="false">{</mo><mi>C</mi><mi>o</mi><mi>l</mi><mi>o</mi><mi>r</mi><mo separator="true">,</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo separator="true">,</mo><mrow><mi>L</mi><mi>e</mi><mi>f</mi><mi>t</mi></mrow><mo separator="true">,</mo><mi>R</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">}</mo><mtext>&nbsp;&nbsp;</mtext><mi>N</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo>→</mo><mo stretchy="false">(</mo><mi>b</mi><mi>a</mi><mi>l</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi><mtext>&nbsp;&nbsp;</mtext><mo stretchy="false">{</mo><mi>C</mi><mi>o</mi><mi>l</mi><mi>o</mi><mi>r</mi><mo separator="true">,</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo separator="true">,</mo><mo stretchy="false">(</mo><mi>a</mi><mi>d</mi><mi>d</mi><mi mathvariant="normal">_</mi><mi>r</mi><mi>b</mi><mi>t</mi><mi mathvariant="normal">_</mi><mtext>&nbsp;&nbsp;</mtext><mrow><mi>L</mi><mi>e</mi><mi>f</mi><mi>t</mi></mrow><mtext>&nbsp;&nbsp;</mtext><mi>N</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>R</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">}</mo><mo stretchy="false">)</mo><mtext>&nbsp;&nbsp;when&nbsp;&nbsp;</mtext><mi>N</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo>&lt;</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo separator="true">;</mo></mrow><annotation encoding="application/x-tex">\mathit{def} ~ ~ add\_rbt\_ :: \lbrace Color, Value, \mathit{Left}, Right \rbrace ~ ~ New\_Value \rightarrow (balance ~ ~ \lbrace Color, Value, (add\_rbt\_ ~ ~ \mathit{Left} ~ ~ New\_Value), Right \rbrace) ~ ~ \text{when}  ~ ~ New\_Value &lt; Value;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.00444em; vertical-align: -0.31em;"></span><span class="mord"><span class="mord mathit">def</span></span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mord mathnormal">b</span><span class="mord mathnormal">t</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">::</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right: 0.07153em;">C</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal" style="margin-right: 0.02778em;">or</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">Left</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.00773em;">R</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span><span class="mclose">}</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mopen">(</span><span class="mord mathnormal">ba</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">an</span><span class="mord mathnormal">ce</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right: 0.07153em;">C</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal" style="margin-right: 0.02778em;">or</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mord mathnormal">b</span><span class="mord mathnormal">t</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord"><span class="mord mathit">Left</span></span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.00773em;">R</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span><span class="mclose">})</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord text"><span class="mord">when</span></span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mpunct">;</span></span></span></span></span></p>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>d</mi><mi>e</mi><mi>f</mi></mrow><mtext>&nbsp;&nbsp;</mtext><mi>a</mi><mi>d</mi><mi>d</mi><mi mathvariant="normal">_</mi><mi>r</mi><mi>b</mi><mi>t</mi><mi mathvariant="normal">_</mi><mo>:</mo><mo>:</mo><mo stretchy="false">{</mo><mi>C</mi><mi>o</mi><mi>l</mi><mi>o</mi><mi>r</mi><mo separator="true">,</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo separator="true">,</mo><mrow><mi>L</mi><mi>e</mi><mi>f</mi><mi>t</mi></mrow><mo separator="true">,</mo><mi>R</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">}</mo><mtext>&nbsp;&nbsp;</mtext><mi>N</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo>→</mo><mo stretchy="false">(</mo><mi>b</mi><mi>a</mi><mi>l</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi><mtext>&nbsp;&nbsp;</mtext><mo stretchy="false">{</mo><mi>C</mi><mi>o</mi><mi>l</mi><mi>o</mi><mi>r</mi><mo separator="true">,</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo separator="true">,</mo><mi>L</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo separator="true">,</mo><mo stretchy="false">(</mo><mi>a</mi><mi>d</mi><mi>d</mi><mi mathvariant="normal">_</mi><mi>r</mi><mi>b</mi><mi>t</mi><mi mathvariant="normal">_</mi><mtext>&nbsp;&nbsp;</mtext><mrow><mi>R</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi></mrow><mtext>&nbsp;&nbsp;</mtext><mi>N</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo><mo stretchy="false">)</mo><mtext>&nbsp;&nbsp;when&nbsp;&nbsp;</mtext><mi>N</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo>&gt;</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo separator="true">;</mo></mrow><annotation encoding="application/x-tex">\mathit{def} ~ ~ add\_rbt\_ :: \lbrace Color, Value, \mathit{Left}, Right \rbrace ~ ~ New\_Value \rightarrow (balance ~ ~ \lbrace Color, Value, Left, (add\_rbt\_ ~ ~ \mathit{Right} ~ ~ New\_Value) \rbrace) ~ ~ \text{when} ~ ~ New\_Value &gt; Value;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.00444em; vertical-align: -0.31em;"></span><span class="mord"><span class="mord mathit">def</span></span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mord mathnormal">b</span><span class="mord mathnormal">t</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">::</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right: 0.07153em;">C</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal" style="margin-right: 0.02778em;">or</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">Left</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.00773em;">R</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span><span class="mclose">}</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mopen">(</span><span class="mord mathnormal">ba</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">an</span><span class="mord mathnormal">ce</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right: 0.07153em;">C</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal" style="margin-right: 0.02778em;">or</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mord mathnormal">b</span><span class="mord mathnormal">t</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord"><span class="mord mathit">Right</span></span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mclose">)})</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord text"><span class="mord">when</span></span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mpunct">;</span></span></span></span></span></p>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>d</mi><mi>e</mi><mi>f</mi></mrow><mtext>&nbsp;&nbsp;</mtext><mi>a</mi><mi>d</mi><mi>d</mi><mi mathvariant="normal">_</mi><mi>r</mi><mi>b</mi><mi>t</mi><mi mathvariant="normal">_</mi><mo>:</mo><mo>:</mo><mi>N</mi><mi>o</mi><mi>d</mi><mi>e</mi><mtext>&nbsp;&nbsp;</mtext><mi>N</mi><mi>e</mi><mi>w</mi><mi mathvariant="normal">_</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo>→</mo><mi>N</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\mathit{def} ~ ~ add\_rbt\_ :: Node ~ ~ New\_Value \rightarrow Node.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.00444em; vertical-align: -0.31em;"></span><span class="mord"><span class="mord mathit">def</span></span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mord mathnormal">b</span><span class="mord mathnormal">t</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">::</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.00444em; vertical-align: -0.31em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right: 0.02691em;">w</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord">.</span></span></span></span></span></p>
</blockquote>
<p>The <code>balance</code> function that is being performed is based on pattern matching defined by an algorithm written by Chris Okasaki (reference Purely Functional Data Structures).  In his algorithm, there are four unbalanced scenarios that need to be balanced.  These adjustments are made when the <code>add_rbt_</code> function is returning from all the recursive calls back up to the new root.  The diagram below shows the four scenarios.</p>
<p><img src="https://macbeth-byui.github.io/cse382-course/images/rbt_balance.drawio.png" alt="rbt scenarios"></p>
<p>The selection of variables in these diagrams was purposeful to suggest that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>&lt;</mo><mi>Y</mi><mo>&lt;</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X &lt; Y &lt; Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72243em; vertical-align: -0.0391em;"></span><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.72243em; vertical-align: -0.0391em;"></span><span class="mord mathnormal" style="margin-right: 0.22222em;">Y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span></span></span></span></span>.  We need code to look for each of these four scenarios.  If we have any of these four, then the solution is the same shown below.</p>
<p><img src="https://macbeth-byui.github.io/cse382-course/images/rbt_balance_result.drawio.png" alt="rbt scenarios"></p>
<p>The specification for our balance is simple as it converts a potentially unbalanced node into a balanced node:</p>
<blockquote>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>p</mi><mi>e</mi><mi>c</mi><mtext>&nbsp;&nbsp;</mtext><mi>b</mi><mi>a</mi><mi>l</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi><mo>:</mo><mo>:</mo><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi><mo>→</mo><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">spec ~ ~ balance :: node \rightarrow node.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">ec</span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">ba</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">an</span><span class="mord mathnormal">ce</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">::</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord">.</span></span></span></span></span></p>
</blockquote>
<p>The definition for this function has 5 clauses (one for each scenario plus one in case none of them match.  The first clause below corresponds to scenario 1.  The next three scenarios are left for an exercise.  The default clause is also given below.</p>
<blockquote>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>d</mi><mi>e</mi><mi>f</mi></mrow><mtext>&nbsp;&nbsp;</mtext><mi>b</mi><mi>a</mi><mi>l</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi><mo>:</mo><mo>:</mo><mo stretchy="false">{</mo><mi>b</mi><mi>l</mi><mi>a</mi><mi>c</mi><mi>k</mi><mo separator="true">,</mo><mi>Z</mi><mo separator="true">,</mo><mo stretchy="false">{</mo><mi>r</mi><mi>e</mi><mi>d</mi><mo separator="true">,</mo><mi>X</mi><mo separator="true">,</mo><mi>A</mi><mo separator="true">,</mo><mo stretchy="false">{</mo><mi>r</mi><mi>e</mi><mi>d</mi><mo separator="true">,</mo><mi>Y</mi><mo separator="true">,</mo><mi>B</mi><mo separator="true">,</mo><mi>C</mi><mo separator="true">,</mo><mo stretchy="false">}</mo><mo stretchy="false">}</mo><mo separator="true">,</mo><mi>D</mi><mo stretchy="false">}</mo><mo stretchy="false">)</mo><mo>→</mo><mo stretchy="false">{</mo><mi>r</mi><mi>e</mi><mi>d</mi><mo separator="true">,</mo><mi>Y</mi><mo separator="true">,</mo><mo stretchy="false">{</mo><mi>b</mi><mi>l</mi><mi>a</mi><mi>c</mi><mi>k</mi><mo separator="true">,</mo><mi>X</mi><mo separator="true">,</mo><mi>A</mi><mo separator="true">,</mo><mi>B</mi><mo stretchy="false">}</mo><mo separator="true">,</mo><mo stretchy="false">{</mo><mi>b</mi><mi>l</mi><mi>a</mi><mi>c</mi><mi>k</mi><mo separator="true">,</mo><mi>Z</mi><mo separator="true">,</mo><mi>C</mi><mo separator="true">,</mo><mi>D</mi><mo stretchy="false">}</mo><mo stretchy="false">}</mo><mo separator="true">;</mo></mrow><annotation encoding="application/x-tex">\mathit{def} ~ ~ balance :: \lbrace black, Z, \lbrace red, X, A, \lbrace red, Y, B, C, \rbrace \rbrace, D \rbrace) \rightarrow \lbrace red, Y, \lbrace black, X, A, B \rbrace, \lbrace black, Z, C, D \rbrace \rbrace;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit">def</span></span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">ba</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">an</span><span class="mord mathnormal">ce</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">::</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mopen">{</span><span class="mord mathnormal">re</span><span class="mord mathnormal">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mopen">{</span><span class="mord mathnormal">re</span><span class="mord mathnormal">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.07153em;">C</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mclose">}}</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">D</span><span class="mclose">})</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">re</span><span class="mord mathnormal">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mopen">{</span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.05017em;">B</span><span class="mclose">}</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mopen">{</span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.07153em;">C</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">D</span><span class="mclose">}}</span><span class="mpunct">;</span></span></span></span></span></p>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>d</mi><mi>e</mi><mi>f</mi></mrow><mtext>&nbsp;&nbsp;</mtext><mi>b</mi><mi>a</mi><mi>l</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi><mo>:</mo><mo>:</mo><mtext>Scenario&nbsp;2&nbsp;left&nbsp;for&nbsp;an&nbsp;exercise</mtext><mo separator="true">;</mo></mrow><annotation encoding="application/x-tex">\mathit{def} ~ ~ balance :: \text{Scenario 2 left for an exercise};</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit">def</span></span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">ba</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">an</span><span class="mord mathnormal">ce</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">::</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord text"><span class="mord">Scenario&nbsp;2&nbsp;left&nbsp;for&nbsp;an&nbsp;exercise</span></span><span class="mpunct">;</span></span></span></span></span></p>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>d</mi><mi>e</mi><mi>f</mi></mrow><mtext>&nbsp;&nbsp;</mtext><mi>b</mi><mi>a</mi><mi>l</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi><mo>:</mo><mo>:</mo><mtext>Scenario&nbsp;3&nbsp;left&nbsp;for&nbsp;an&nbsp;exercise</mtext><mo separator="true">;</mo></mrow><annotation encoding="application/x-tex">\mathit{def} ~ ~ balance :: \text{Scenario 3 left for an exercise};</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit">def</span></span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">ba</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">an</span><span class="mord mathnormal">ce</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">::</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord text"><span class="mord">Scenario&nbsp;3&nbsp;left&nbsp;for&nbsp;an&nbsp;exercise</span></span><span class="mpunct">;</span></span></span></span></span></p>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>d</mi><mi>e</mi><mi>f</mi></mrow><mtext>&nbsp;&nbsp;</mtext><mi>b</mi><mi>a</mi><mi>l</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi><mo>:</mo><mo>:</mo><mtext>Scenario&nbsp;4&nbsp;left&nbsp;for&nbsp;an&nbsp;exercise</mtext><mo separator="true">;</mo></mrow><annotation encoding="application/x-tex">\mathit{def} ~ ~ balance :: \text{Scenario 4 left for an exercise};</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit">def</span></span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">ba</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">an</span><span class="mord mathnormal">ce</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">::</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord text"><span class="mord">Scenario&nbsp;4&nbsp;left&nbsp;for&nbsp;an&nbsp;exercise</span></span><span class="mpunct">;</span></span></span></span></span></p>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>d</mi><mi>e</mi><mi>f</mi></mrow><mtext>&nbsp;&nbsp;</mtext><mi>b</mi><mi>a</mi><mi>l</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi><mo>:</mo><mo>:</mo><mi>N</mi><mi>o</mi><mi>d</mi><mi>e</mi><mo>→</mo><mi>N</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\mathit{def} ~ ~ balance :: Node \rightarrow Node.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit">def</span></span><span class="mspace nobreak">&nbsp;</span><span class="mspace nobreak">&nbsp;</span><span class="mord mathnormal">ba</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">an</span><span class="mord mathnormal">ce</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">::</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord">.</span></span></span></span></span></p>
</blockquote>
<p>The Erlang code for the definitions provided above is given below.  The remaining code is left for an exercise.</p>
<pre class=" language-erlang"><code class="prism  language-erlang"><span class="token function">balance</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token atom">black</span><span class="token punctuation">,</span><span class="token variable">Z</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token atom">red</span><span class="token punctuation">,</span><span class="token variable">X</span><span class="token punctuation">,</span><span class="token variable">A</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token atom">red</span><span class="token punctuation">,</span><span class="token variable">Y</span><span class="token punctuation">,</span><span class="token variable">B</span><span class="token punctuation">,</span><span class="token variable">C</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token variable">D</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token atom">red</span><span class="token punctuation">,</span><span class="token variable">Y</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token atom">black</span><span class="token punctuation">,</span><span class="token variable">X</span><span class="token punctuation">,</span><span class="token variable">A</span><span class="token punctuation">,</span><span class="token variable">B</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token atom">black</span><span class="token punctuation">,</span><span class="token variable">Z</span><span class="token punctuation">,</span><span class="token variable">C</span><span class="token punctuation">,</span><span class="token variable">D</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">% Scenarios 2, 3, and 4 are left for an exercise</span>
<span class="token function">balance</span><span class="token punctuation">(</span><span class="token variable">Node</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token variable">Node</span><span class="token punctuation">.</span>
</code></pre>
<h2 id="problem-set-2">Problem Set 2</h2>
<ol>
<li>Complete the add functionality for the RBT.  The <code>add_rbt</code> function is written for you and you need to write the <code>add_rbt_</code> as described in the specification and definition above.  Implement the <code>add_rbt_</code> function per the specification and definition above.  You will also need to finish implementing the <code>balance</code> function for cases 2, 3, and 4 per the diagrams above.  Use the test code provided.</li>
<li>Implement the <code>contains_rbt</code> function per the specification above.  Use the test code provided.</li>
</ol>
<h2 id="part-3---performance">Part 3 - Performance</h2>
<p>The binary search tree from Part 1 has performance of O(log n) if its balanced but as it becomes unbalanced, it becomes O(n).  The RBT from Part 2 has performance of O(log n) because it maintains the balanced state.  Even though there is more work needed to balance, it is offset by ability to find the spot for new nodes because its balanced.</p>
<p>To compare the performance of both approaches for a tree with 10,000 nodes in the problem set below, we will use the <code>fprof</code> library in Erlang.  This library will report the number of times a function runs and the execution time of those functions.  As with tools like these, there is an overhead cost for running <code>fprof</code> but it will not prevent us from making observations.</p>
<p>The following utility functions can be put around code to display performance results.</p>
<pre class=" language-erlang"><code class="prism  language-erlang"><span class="token function">start_perf</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span>
	<span class="token atom">eprof</span><span class="token punctuation">:</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token atom">eprof</span><span class="token punctuation">:</span><span class="token function">start_profiling</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">self</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>

<span class="token function">stop_perf</span><span class="token punctuation">(</span><span class="token variable">Title</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span>
	<span class="token atom">io</span><span class="token punctuation">:</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"Perf (~p): ~n"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token variable">Title</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token atom">eprof</span><span class="token punctuation">:</span><span class="token function">stop_profiling</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token atom">eprof</span><span class="token punctuation">:</span><span class="token function">analyze</span><span class="token punctuation">(</span><span class="token atom">total</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token atom">eprof</span><span class="token punctuation">:</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
</code></pre>
<p>If we wanted to compare the cost of adding to the front of a list and the cost of adding to the end of list, we would create a single <code>foldl</code> to perform those operations using a sequence of numbers from 1 to 10,000.</p>
<pre class=" language-erlang"><code class="prism  language-erlang"><span class="token function">timing_test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span>
	<span class="token function">start_perf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token atom">lists</span><span class="token punctuation">:</span><span class="token function">foldl</span><span class="token punctuation">(</span><span class="token keyword">fun</span> <span class="token punctuation">(</span><span class="token variable">Value</span><span class="token punctuation">,</span> <span class="token variable">Acc</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token function">prepend</span><span class="token punctuation">(</span><span class="token variable">Acc</span><span class="token punctuation">,</span> <span class="token variable">Value</span><span class="token punctuation">)</span> <span class="token keyword">end</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token atom">lists</span><span class="token punctuation">:</span><span class="token function">seq</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token function">stop_perf</span><span class="token punctuation">(</span><span class="token string">"prepend"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

	<span class="token function">start_perf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token atom">lists</span><span class="token punctuation">:</span><span class="token function">foldl</span><span class="token punctuation">(</span><span class="token keyword">fun</span> <span class="token punctuation">(</span><span class="token variable">Value</span><span class="token punctuation">,</span> <span class="token variable">Acc</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token variable">Acc</span><span class="token punctuation">,</span> <span class="token variable">Value</span><span class="token punctuation">)</span> <span class="token keyword">end</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token atom">lists</span><span class="token punctuation">:</span><span class="token function">seq</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token function">stop_perf</span><span class="token punctuation">(</span><span class="token string">"append"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

	<span class="token atom">pass</span><span class="token punctuation">.</span>
</code></pre>
<p>The code will take several seconds to run.  The output of <code>fprof</code> will include your functions and several others.  Sample output of <code>fprof</code> for this code including only the functions we are testing is given below:</p>
<pre class=" language-shell"><code class="prism  language-shell">Perf ("prepend"):
FUNCTION                          CALLS        %  TIME  [uS / CALLS]
--------                          -----  -------  ----  [----------]
prove08:prepend/2                 10000    22.91  1126  [      0.11]
--------------------------------  -----  -------  ----  [----------]
Total:                            32524  100.00%  4914  [      0.15]

Perf ("append"): 
FUNCTION                             CALLS        %     TIME  [uS / CALLS]
--------                             -----  -------     ----  [----------]
prove08:append/2                  50005000    99.94  9867673  [      0.20]
--------------------------------  --------  -------  -------  [----------]
Total:                            50027524  100.00%  9873713  [      0.20]
</code></pre>
<p>We can see that the <code>prepend</code> was much faster taking about 1 millisecond versus <code>append</code> taking almost 10 seconds.  The cost of each call wasn’t too much different.    The <code>append</code> was plagued by all the recursive calls to add the item to the end of the list.  We can see the O(n<sup>2</sup>) behavior of <code>append</code> when add <code>n</code> items.</p>
<h2 id="problem-set-3">Problem Set 3</h2>
<ol>
<li>Compare the performance of the Binary Search Tree (<code>add</code> and <code>contains</code>) and the Red Black Tree (<code>add_rbt</code> and <code>contains_rbt</code>).  Use the <code>fprof</code> library to add up the total time using these functions (remember that <code>add_rbt</code> uses <code>add_rbt_</code> and <code>balance</code> as well).   Add the numbers 1 to 10,000 to both data structures in order using a <code>foldl</code> (use the <code>lists:seq</code> function to generate the list of numbers for the <code>foldl</code>). This will result in the worst unbalanced tree using <code>add</code>.  Do a search for the value 10,000 to force the largest search for <code>add</code>.  Compare the performances for our 4 functions and explain what you found.</li>
</ol>

    </div>
  </div>
</body>

</html>
